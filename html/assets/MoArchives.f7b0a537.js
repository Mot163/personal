import{a as d}from"./article-service.mod.9ac4e188.js";import{s as _}from"./index.5b561da9.js";import{_ as p}from"./_plugin-vue_export-helper.cdc0426e.js";const h={class:"mo-archives"},V={class:"mo-archives__container"},v={key:0,class:"mo-archives__tips mo-archives__tips--loading"},g={key:1,class:"mo-archives__tips"},f={__name:"MoArchives",setup(y){const e=Vue.reactive({page:0,pageSize:_.getObject("pageSize").home,total:0,length:0,yearMonthList:[],listData:[]}),n=Vue.ref(!1),s=Vue.computed(()=>e.length===e.total&&e.page>0),c=async()=>{s.value||n.value||(n.value=!0,e.page+=1,await d.list({},e.page,e.pageSize).then(o=>{n.value=!1,e.total=o.data.total,e.length+=o.data.list.length,o.data.list.map(l=>{const a=l.createTime.substring(0,7);e.yearMonthList.includes(a)||(e.yearMonthList.push(a),e.listData.push({yearMonth:a.replace("-","\u5E74")+"\u6708"})),e.listData.push(l)})}).catch(o=>{n.value=!1}))},i=()=>{const o=document.documentElement.clientHeight,l=document.documentElement.scrollTop,a=document.documentElement.scrollHeight;Math.abs(a-o-l)<20&&c()};return Vue.onMounted(async()=>{do await c();while(document.querySelector(".mo-archives").clientHeight<document.documentElement.clientHeight);document.addEventListener("scroll",i,!1)}),Vue.onBeforeUnmount(()=>{document.removeEventListener("scroll",i,!1)}),(o,l)=>{const a=Vue.resolveComponent("router-link"),r=Vue.resolveComponent("el-timeline-item"),u=Vue.resolveComponent("el-timeline");return Vue.openBlock(),Vue.createElementBlock("div",h,[Vue.createElementVNode("div",V,[Vue.createVNode(u,{class:"mo-archives__timeline"},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(e.listData,(t,m)=>(Vue.openBlock(),Vue.createBlock(r,{key:m,class:Vue.normalizeClass(t.id?"":"mo-archives__year-month"),placement:"top",type:"primary",size:t.id?"normal":"large",hollow:!!t.id,timestamp:t.createTime,"hide-timestamp":!t.id},{default:Vue.withCtx(()=>[t.id?(Vue.openBlock(),Vue.createBlock(a,{key:0,class:"mo-archives__link",to:`/article/${t.id}`},{default:Vue.withCtx(()=>[Vue.createTextVNode(Vue.toDisplayString(t.title),1)]),_:2},1032,["to"])):Vue.createCommentVNode("",!0),Vue.createElementVNode("span",null,Vue.toDisplayString(t.yearMonth),1)]),_:2},1032,["class","size","hollow","timestamp","hide-timestamp"]))),128))]),_:1}),n.value?(Vue.openBlock(),Vue.createElementBlock("span",v)):Vue.createCommentVNode("",!0),Vue.unref(s)?(Vue.openBlock(),Vue.createElementBlock("span",g," \u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86~ ")):Vue.createCommentVNode("",!0)])])}}},C=p(f,[["__scopeId","data-v-23410d8b"]]);export{C as default};
